From d2b3120b5f9ba2f5f59fcf6468814efb77a4b1ed Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Thu, 31 Mar 2016 19:26:08 -0500
Subject: [PATCH] Revert "dlm: config: Fix ENOMEM failures in make_cluster()"

This reverts commit 82c7d823cc31cf56d964eebe1f91aaf1691cddce.

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 fs/dlm/config.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/fs/dlm/config.c b/fs/dlm/config.c
index 1669f62..5191121 100644
--- a/fs/dlm/config.c
+++ b/fs/dlm/config.c
@@ -343,12 +343,13 @@ static struct config_group *make_cluster(struct config_group *g,
 	struct dlm_cluster *cl = NULL;
 	struct dlm_spaces *sps = NULL;
 	struct dlm_comms *cms = NULL;
+	void *gps = NULL;
 
 	cl = kzalloc(sizeof(struct dlm_cluster), GFP_NOFS);
 	sps = kzalloc(sizeof(struct dlm_spaces), GFP_NOFS);
 	cms = kzalloc(sizeof(struct dlm_comms), GFP_NOFS);
 
-	if (!cl || !sps || !cms)
+	if (!cl || !gps || !sps || !cms)
 		goto fail;
 
 	config_group_init_type_name(&cl->group, name, &cluster_type);
-- 
2.8.0.rc3

