From 9cccc6528a41c03ecc39ca12002e456b1cffb6a9 Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Fri, 22 Aug 2014 10:06:22 -0500
Subject: [PATCH 12/17] am335x-bone-common: pinmux led/keys lcd4-01-00a1 &
 lcd7-01-00a3

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi   | 26 +++++++++++
 .../arm/boot/dts/am335x-bone-lcd-led-gpio1-28.dtsi | 23 ++++++++++
 arch/arm/boot/dts/am335x-bone-lcd4-01-00a1.dtsi    | 52 ++++++++++++++++++++++
 arch/arm/boot/dts/am335x-bone-lcd7-01-00a3.dtsi    | 52 ++++++++++++++++++++++
 4 files changed, 153 insertions(+)
 create mode 100644 arch/arm/boot/dts/am335x-bone-lcd-led-gpio1-28.dtsi

diff --git a/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi b/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
index e0d4fba..1a7d71b 100644
--- a/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
@@ -142,6 +142,32 @@
 		>;
 	};
 
+	lcd_gpio1_28_led_pins: pinmux_lcd_gpio1_28_led_pins {
+		pinctrl-single,pins = <
+			0x078 0x2f	/* gpmc_ben1.gpio1_28, INPUT | PULLDIS | MODE7 */
+		>;
+	};
+
+	lcd4_01_00a2_keymap_pins: pinmux_lcd4_01_00a2_keymap_pins {
+		pinctrl-single,pins = <
+			0x040 0x2f	/* KEY_LEFT gpmc_a0.gpio1_16, INPUT | PULLDIS | MODE7 */
+			0x044 0x2f	/* KEY_RIGHT gpmc_a1.gpio1_17, INPUT | PULLDIS | MODE7 */
+			0x04c 0x2f 	/* KEY_UP gpmc_a3.gpio1_19, INPUT | PULLDIS | MODE7 */
+			0x198 0x2f	/* KEY_DOWN mcasp0_axr0.gpio3_16, INPUT | PULLDIS | MODE7 */
+			0x184 0x2f	/* KEY_ENTER uart1_txd.gpio0_15, INPUT | PULLDIS | MODE7 */
+		>;
+	};
+
+	lcd7_01_00a3_keymap_pins: pinmux_lcd7_01_00a3_keymap_pins {
+		pinctrl-single,pins = <
+			0x040 0x2f	/* KEY_LEFT gpmc_a0.gpio1_16, INPUT | PULLDIS | MODE7 */
+			0x044 0x2f	/* KEY_RIGHT gpmc_a1.gpio1_17, INPUT | PULLDIS | MODE7 */
+			0x04c 0x2f 	/* KEY_UP gpmc_a3.gpio1_19, INPUT | PULLDIS | MODE7 */
+			0x198 0x2f	/* KEY_DOWN mcasp0_axr0.gpio3_16, INPUT | PULLDIS | MODE7 */
+			0x154 0x2f	/* KEY_ENTER spi0_d0.gpio0_3, INPUT | PULLDIS | MODE7 */
+		>;
+	};
+
 	mcasp0_pins: mcasp0_pins {
 		pinctrl-single,pins = <
 			0x1ac (PIN_INPUT_PULLUP | MUX_MODE0)    /* mcasp0_ahclkx.mcasp0_ahclkx */
diff --git a/arch/arm/boot/dts/am335x-bone-lcd-led-gpio1-28.dtsi b/arch/arm/boot/dts/am335x-bone-lcd-led-gpio1-28.dtsi
new file mode 100644
index 0000000..dffc81f
--- /dev/null
+++ b/arch/arm/boot/dts/am335x-bone-lcd-led-gpio1-28.dtsi
@@ -0,0 +1,23 @@
+/*
+ * Copyright (C) 2012 Texas Instruments Incorporated - http://www.ti.com/
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+/ {
+	gpio-leds-cape-lcd {
+		compatible = "gpio-leds";
+		pinctrl-names = "default";
+
+		pinctrl-0 = <&lcd_gpio1_28_led_pins>;
+
+		lcd-led0 {
+			label = "lcd:green:usr0";
+			gpios = <&gpio1 28 0>;
+			linux,default-trigger = "heartbeat";
+			default-state = "off";
+		};
+	};
+};
diff --git a/arch/arm/boot/dts/am335x-bone-lcd4-01-00a1.dtsi b/arch/arm/boot/dts/am335x-bone-lcd4-01-00a1.dtsi
index 16ba709..99c7cd3 100644
--- a/arch/arm/boot/dts/am335x-bone-lcd4-01-00a1.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-lcd4-01-00a1.dtsi
@@ -6,6 +6,58 @@
  * published by the Free Software Foundation.
  */
 
+/ {
+	gpio_keys {
+		compatible = "gpio-keys";
+		pinctrl-names = "default";
+		pinctrl-0 = <&lcd4_01_00a2_keymap_pins>;
+
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		button@1 {
+			debounce_interval = <50>;
+			linux,code = <105>;
+			label = "left";
+			gpios = <&gpio1 16 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@2 {
+			debounce_interval = <50>;
+			linux,code = <106>;
+			label = "right";
+			gpios = <&gpio1 17 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@3 {
+			debounce_interval = <50>;
+			linux,code = <103>;
+			label = "up";
+			gpios = <&gpio1 19 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@4 {
+			debounce_interval = <50>;
+			linux,code = <108>;
+			label = "down";
+			gpios = <&gpio3 16 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@5 {
+			debounce_interval = <50>;
+			linux,code = <28>;
+			label = "enter";
+			gpios = <&gpio0 15 0x1>;
+			gpio-key,wakeup;
+		};
+	};
+};
+
+#include "am335x-bone-lcd-led-gpio1-28.dtsi"
 #include "am335x-bone-lcd-gpio-backlight-gpio1-18.dtsi"
 #include "am335x-bone-ti-tscadc-4-wire.dtsi"
 #include "am335x-bone-lcd4.dtsi"
diff --git a/arch/arm/boot/dts/am335x-bone-lcd7-01-00a3.dtsi b/arch/arm/boot/dts/am335x-bone-lcd7-01-00a3.dtsi
index f35157f..a31f787 100644
--- a/arch/arm/boot/dts/am335x-bone-lcd7-01-00a3.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-lcd7-01-00a3.dtsi
@@ -6,6 +6,58 @@
  * published by the Free Software Foundation.
  */
 
+/ {
+	gpio_keys {
+		compatible = "gpio-keys";
+		pinctrl-names = "default";
+		pinctrl-0 = <&lcd7_01_00a3_keymap_pins>;
+
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		button@1 {
+			debounce_interval = <50>;
+			linux,code = <105>;
+			label = "left";
+			gpios = <&gpio1 16 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@2 {
+			debounce_interval = <50>;
+			linux,code = <106>;
+			label = "right";
+			gpios = <&gpio1 17 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@3 {
+			debounce_interval = <50>;
+			linux,code = <103>;
+			label = "up";
+			gpios = <&gpio1 19 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@4 {
+			debounce_interval = <50>;
+			linux,code = <108>;
+			label = "down";
+			gpios = <&gpio3 16 0x1>;
+			gpio-key,wakeup;
+			autorepeat;
+		};
+		button@5 {
+			debounce_interval = <50>;
+			linux,code = <28>;
+			label = "enter";
+			gpios = <&gpio0 3 0x1>;
+			gpio-key,wakeup;
+		};
+	};
+};
+
+#include "am335x-bone-lcd-led-gpio1-28.dtsi"
 #include "am335x-bone-lcd-gpio-backlight-gpio1-18.dtsi"
 #include "am335x-bone-ti-tscadc-4-wire.dtsi"
 #include "am335x-bone-lcd7.dtsi"
-- 
2.1.0.rc1

