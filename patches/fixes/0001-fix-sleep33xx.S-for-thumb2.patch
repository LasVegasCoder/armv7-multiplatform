From 41e5447c803211e5bde9688cc16638a0fda4d9ee Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Fri, 15 Jan 2016 15:18:54 -0600
Subject: [PATCH 1/4] fix sleep33xx.S: for thumb2

<zmatt> rcn-ee: btw, I got a small patch that makes 4.1-ti compile in thumb mode
again, you want it?  (this means TI still compiles in ARM mode?  why oh why?)
<zmatt> http://pastebin.com/3S3sy8U4

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/mach-omap2/sleep33xx.S | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/arch/arm/mach-omap2/sleep33xx.S b/arch/arm/mach-omap2/sleep33xx.S
index 5185fe0..d033434 100644
--- a/arch/arm/mach-omap2/sleep33xx.S
+++ b/arch/arm/mach-omap2/sleep33xx.S
@@ -165,7 +165,9 @@ wait_emif_enable1:
 	cmp	r1, r2
 	bne	wait_emif_enable1
 
-	adr	sp, temp_stack
+ARM(	adr	sp, temp_stack )
+THUMB(	adr	r1, temp_stack )
+THUMB(	mov	sp, r1 )
 
 	ldr	r1, ti_emif_restore_context
 	blx	r1
-- 
2.7.0

